<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button></ion-back-button>
    </ion-buttons>

    <ion-title>Print Test</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <!-- Protocol Selection -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Protocol Selection</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-segment [(ngModel)]="selectedProtocol" (ionChange)="onProtocolChange()">
        <ion-segment-button value="POS">
          <ion-label>POS</ion-label>
        </ion-segment-button>
        <ion-segment-button value="CPCL">
          <ion-label>CPCL</ion-label>
        </ion-segment-button>
        <ion-segment-button value="TSPL">
          <ion-label>TSPL</ion-label>
        </ion-segment-button>
        <ion-segment-button value="ZPL">
          <ion-label>ZPL</ion-label>
        </ion-segment-button>
      </ion-segment>
    </ion-card-content>
  </ion-card>

  <!-- Print Functions -->
  <ion-grid>
    <ion-row>
      <ion-col size="6" size-md="4">
        <div class="print-box" (click)="onPrintText()">
          <ion-icon name="text-outline"></ion-icon>
          <p>Text</p>
        </div>
      </ion-col>
      <ion-col size="6" size-md="4">
        <div class="print-box" (click)="onPrintQRCode()">
          <ion-icon name="qr-code-outline"></ion-icon>
          <p>QR Code</p>
        </div>
      </ion-col>
      <ion-col size="6" size-md="4">
        <div class="print-box" (click)="onPrintBarcode()">
          <ion-icon name="barcode-outline"></ion-icon>
          <p>Barcode</p>
        </div>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col size="6" size-md="4">
        <div class="print-box" (click)="selectImageFromLibraryAndPrintPath()">
          <ion-icon name="image-outline"></ion-icon>
          <p>Image (Path)</p>
        </div>
      </ion-col>
      <ion-col size="6" size-md="4">
        <div class="print-box" (click)="captureImageAndPrintBase64()">
          <ion-icon name="images-outline"></ion-icon>
          <p>Image (Base64)</p>
        </div>
      </ion-col>
      <ion-col size="6" size-md="4">
        <div class="print-box" (click)="onSendRawData()">
          <ion-icon name="code-outline"></ion-icon>
          <p>Raw Data</p>
        </div>
      </ion-col>
    </ion-row>

    <!-- POS Only Functions -->
    <ion-row *ngIf="selectedProtocol === 'POS'">
      <ion-col size="6" size-md="4">
        <div class="print-box" (click)="onCutPaper()">
          <ion-icon name="cut-outline"></ion-icon>
          <p>Cut Paper</p>
        </div>
      </ion-col>
      <ion-col size="6" size-md="4">
        <div class="print-box" (click)="onOpenCashDrawer()">
          <ion-icon name="cash-outline"></ion-icon>
          <p>Cash Drawer</p>
        </div>
      </ion-col>
      <ion-col size="6" size-md="4">
        <div class="print-box" (click)="onSelfTest()">
          <ion-icon name="checkmark-circle-outline"></ion-icon>
          <p>Self Test</p>
        </div>
      </ion-col>
    </ion-row>

    <!-- Config Label for CPCL/TSPL/ZPL -->
    <ion-row *ngIf="selectedProtocol !== 'POS'">
      <ion-col size="6" size-md="4">
        <div class="print-box" (click)="onConfigLabel()">
          <ion-icon name="document-outline"></ion-icon>
          <p>Config Label</p>
        </div>
      </ion-col>
    </ion-row>

    <!-- Utility Functions -->
    <ion-row>
      <ion-col size="6" size-md="4">
        <div class="print-box" (click)="onGetPrinterStatus()">
          <ion-icon name="information-circle-outline"></ion-icon>
          <p>Printer Status</p>
        </div>
      </ion-col>
      <ion-col size="6" size-md="4">
        <div class="print-box" (click)="onResetPrinter()" *ngIf="selectedProtocol === 'POS'">
          <ion-icon name="refresh-outline"></ion-icon>
          <p>Reset Printer</p>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- Config Cards -->
  <ion-card>
    <ion-card-header><ion-card-title>Cấu hình Label</ion-card-title></ion-card-header>
    <ion-card-content>
      <ion-item><ion-label position="floating">Width</ion-label><ion-input type="number" [(ngModel)]="labelConfig.width"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Height</ion-label><ion-input type="number" [(ngModel)]="labelConfig.height"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Gap</ion-label><ion-input type="number" [(ngModel)]="labelConfig.gap"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Quantity</ion-label><ion-input type="number" [(ngModel)]="labelConfig.quantity"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Length (ZPL)</ion-label><ion-input type="number" [(ngModel)]="labelConfig.length"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Speed (ZPL)</ion-label><ion-input type="number" [(ngModel)]="labelConfig.speed"></ion-input></ion-item>
      <ion-button expand="block" (click)="onConfigLabel()">Cấu hình Label</ion-button>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header><ion-card-title>Cấu hình Barcode</ion-card-title></ion-card-header>
    <ion-card-content>
      <ion-item><ion-label position="floating">Height</ion-label><ion-input type="number" [(ngModel)]="barcodeConfig.height"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Width</ion-label><ion-input type="number" [(ngModel)]="barcodeConfig.width"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Code Type</ion-label><ion-input [(ngModel)]="barcodeConfig.codeType"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Readable</ion-label><ion-input type="number" [(ngModel)]="barcodeConfig.readable"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Rotation</ion-label><ion-input type="number" [(ngModel)]="barcodeConfig.rotation"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Narrow</ion-label><ion-input type="number" [(ngModel)]="barcodeConfig.narrow"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Wide</ion-label><ion-input type="number" [(ngModel)]="barcodeConfig.wide"></ion-input></ion-item>
      <ion-button expand="block" (click)="onConfigBarcode()">Cấu hình Barcode</ion-button>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header><ion-card-title>Cấu hình QRCode</ion-card-title></ion-card-header>
    <ion-card-content>
      <ion-item><ion-label position="floating">Size</ion-label><ion-input type="number" [(ngModel)]="qrcodeConfig.size"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Model</ion-label><ion-input type="number" [(ngModel)]="qrcodeConfig.model"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Unit Width</ion-label><ion-input type="number" [(ngModel)]="qrcodeConfig.unitWidth"></ion-input></ion-item>
      <ion-item><ion-label position="floating">EC Level</ion-label><ion-input type="number" [(ngModel)]="qrcodeConfig.ecLevel"></ion-input></ion-item>
      <ion-button expand="block" (click)="onConfigQRCode()">Cấu hình QRCode</ion-button>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header><ion-card-title>Cấu hình Image</ion-card-title></ion-card-header>
    <ion-card-content>
      <ion-item><ion-label position="floating">Mode</ion-label><ion-input type="number" [(ngModel)]="imageConfig.mode"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Width</ion-label><ion-input type="number" [(ngModel)]="imageConfig.width"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Height</ion-label><ion-input type="number" [(ngModel)]="imageConfig.height"></ion-input></ion-item>
      <ion-button expand="block" (click)="onConfigImage()">Cấu hình Image</ion-button>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header><ion-card-title>Cấu hình Text</ion-card-title></ion-card-header>
    <ion-card-content>
      <ion-item><ion-label position="floating">Font</ion-label><ion-input type="number" [(ngModel)]="textConfig.font"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Size</ion-label><ion-input type="number" [(ngModel)]="textConfig.size"></ion-input></ion-item>
      <ion-item><ion-label position="floating">Rotation</ion-label><ion-input type="number" [(ngModel)]="textConfig.rotation"></ion-input></ion-item>
      <ion-button expand="block" (click)="onConfigText()">Cấu hình Text</ion-button>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-card-title>Gửi lệnh tuỳ ý (ZPL/CPCL/TSPL...)</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-item>
        <ion-label position="floating">Lệnh máy in</ion-label>
        <ion-textarea autoGrow="true" [(ngModel)]="customCommand"></ion-textarea>
      </ion-item>
      <ion-button expand="block" (click)="onSendCommand()">Gửi lệnh</ion-button>
    </ion-card-content>
  </ion-card>
</ion-content>
